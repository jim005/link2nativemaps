<!DOCTYPE html>
<html>
<head>
    <meta name="robots" content="noindex">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta http-equiv="pragma" content="no-cache">

    <script>
        let os = navigator.platform;
        let redirectUrl;
        let q = new URLSearchParams(window.location.search).get("q");
        let ll = new URLSearchParams(window.location.search).get("ll");
        let url;

        if (!q || q === "") {
            window.location.href = "https://www.qwant.com";
        }

        function getLatLong(string) {
            const latLongRegex = /(^\-?\d+\.*\d*\,\-?\d+\.*\d*)/m;
            const matches = string.match(latLongRegex);
            if (matches) {
                const latLongArray = matches[0].split(",");
                const lat = parseFloat(latLongArray[0]);
                const lon = parseFloat(latLongArray[1]);
                return [lat, lon];
            }
            return false;
        }


        if (os.indexOf("iPhone") != -1 || os.indexOf("iPad") != -1 || os.indexOf("Mac") != -1) {
            redirectUrl = `https://maps.apple.com/?q=${q}`;
            redirectUrl += ll ? `&ll=${ll}` : "";
        } else if (os.indexOf("Android") != -1) {
            redirectUrl = `https://www.google.com/maps/search/?api=1&query=${q}`;
            redirectUrl += ll ? `+${ll}` : "";
        } else {
            redirectUrl = "https://www.qwant.com/maps/place/latlon:";
            if (ll) {
                const latLongArray = getLatLong(ll);
            } else {
            	const latLongArray = getLatLong(q);
            }
			redirectUrl += `${latLongArray[0]}:${latLongArray[1]}`;
        }

        window.location.href = redirectUrl;
    	setTimeout (window.close, 1000);  // Fix for Apple Map on native app

    </script>
</head>
<body>
=> https://www.qwant.com/maps/
</body>
</html>